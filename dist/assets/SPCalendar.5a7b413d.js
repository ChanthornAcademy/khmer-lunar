import{r as k,u as q,h as _,o as g,c as p,a as t,b as ce,d as ve,w as X,e as C,f as O,g as M,i as Q,v as Z,F as I,j as U,t as x,n as F,k as z,l as R,m as he,_ as fe}from"./index.7dde8207.js";import{l as me,m as P}from"./moment-with-locales.5b31333c.js";function be(e){const a=k([]),{khmerNewYearDate:v}=q();let d=v.value(e.year).days;return d.forEach((i,m)=>{let n={};m===0?n={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u1798\u17A0\u17B6\u179F\u1784\u17D2\u179A\u17D2\u1780\u17B6\u1793\u17D2\u178F)",en:"Khmer New Year's Day (Moha Sangkranta)"}:i===d[d.length-1]?n={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u179C\u17B6\u179A\u17C8\u17A1\u17BE\u1784\u179F\u17D0\u1780)",en:"Khmer New Year's Day (Veareak Laeung Sak)"}:n={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u179C\u17B6\u179A\u17C8\u179C\u17D0\u1793\u1794\u178F)",en:"Khmer New Year's Day (Veareak Vanabat)"},a.value.push({key:"traditional_holidays"+_(i).format("YYYY-MM-DD"),customData:{title:n,description:"Holiday in Cambodia",class:"bg-red-600 text-white"},dates:_(i).format("YYYY-MM-DD")})}),{khmerNewYearAttrs:a}}const ge="/khmer-lunar/assets/buddhist-icon.d62fdc83.webp";function V(e,a){return g(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z","clip-rule":"evenodd"})])}function W(e,a){return g(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function pe(e,a){return g(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}const ye={class:"p-5"},_e={class:"mb-3 rounded-xl md:divide-x-4 border p-2 flex flex-col md:flex-row items-center justify-center text-lg font-hanuman"},xe={class:"flex items-center gap-1 px-4"},Ye=t("label",null,"Month: ",-1),we=["onClick"],ke=["value"],Me=["onClick"],De={class:"flex items-center gap-1 px-4"},je=t("label",null,"Year: ",-1),$e=["onClick"],Te=["value"],Ce=["onClick"],Se={class:"font-nokora w-full bg-white border mx-auto p-2 rounded-xl"},Oe={class:"items-center justify-between flex mb-4"},Ne={class:"shrink-0 text-right text-lg font-bold"},Ie={class:"text-center w-full"},Le={class:"text-lg md:text-xl lg:text-2xl font-bold"},Ee={class:"text-lg md:text-xl text-gray-600 font-bold"},Pe={class:"flex gap-1 items-center justify-between shrink-0"},Ke=["onClick"],Be=["onClick"],He=["onClick"],Ue={class:"flex gap-2 justify-between text-center items-center mb-2 bg-white rounded-md border overflow-hidden font-bold text-base md:text-lg whitespace-nowrap"},Fe={class:"grid gap-2 grid-cols-7"},Re=["onClick"],ze={class:"flex lg:gap-1 flex-col items-center md:flex-row md:items-start"},Ge={class:"text-lg md:text-3xl font-bold shrink-0"},Ve={class:"w-full flex justify-center flex-col md:justify-start items-center md:items-end font-nokora text-sm md:text-base text-center"},We={key:0,class:"absolute inset-0 rounded-md overflow-hidden flex justify-center z-10 opacity-30 lg:static lg:opacity-100 p-1"},Ae=t("img",{src:ge,alt:"Buddhist",class:"h-full object-cover object-top lg:w-6 lg:h-auto lg:object-contain"},null,-1),Xe=[Ae],qe={key:0,class:"text-blue-600 font-bold hidden md:block"},Je={__name:"TheCalendar",props:{attributes:Object},emits:["onPrev","onNext","onUpdatePage","onClick"],setup(e,{emit:a}){const v=e,{khmerDate:d}=q(),i=k([]),m=k([]),n=k(_().month()+1),o=k(_().year()),b=k([]),y=ce(()=>_(o.value+"-"+n.value+"-1","YYYY-M-D").locale("en")),S=k([]),D=()=>{n.value--,n.value===0&&(n.value=12,o.value--),a("onPrev",{month:n.value,year:o.value}),a("onUpdatePage",{month:n.value,year:o.value})},N=()=>{n.value++,n.value===13&&(n.value=1,o.value++),a("onNext",{month:n.value,year:o.value}),a("onUpdatePage",{month:n.value,year:o.value})},s=()=>{o.value--},Y=()=>{o.value++},c=()=>{n.value=_().month()+1,o.value=_().year()},w=l=>{a("onClick",l)};ve(()=>{m.value.length=0,j()});const j=()=>{a("onPrev",{month:n.value,year:o.value}),a("onNext",{month:n.value,year:o.value}),a("onUpdatePage",{month:n.value,year:o.value}),i.value.length=0,b.value.length=0;for(let f=0;f<7;f++)i.value.push({en:_().day(f),km:_().clone().day(f)});let l=y.value,h=l.clone().daysInMonth(),r=l.day(),ue=7-_(l.format("YYYY-MM-"+h)).day()-1,de=l.clone().subtract(1,"months").daysInMonth();for(let f=r;f>0;f--){let T=de-f+1,E=_(l.clone().subtract(1,"months").format("YYYY-MM-"+T),"YYYY-MM-D");m.value.push({prevMonth:!0,day:T,date:E,khDate:d.value(E),nextMonth:!1,attributes:K(E)})}for(let f=1;f<=h;f++){let T=_(l.format("YYYY-MM-"+f),"YYYY-MM-D"),E=d.value(T);m.value.push({prevMonth:!1,day:f,date:T,khDate:E,nextMonth:!1,attributes:K(T)}),b.value.push(E.toKhDate("m"))}for(let f=1;f<=ue;f++){let T=_(l.clone().add(1,"months").format("YYYY-MM-"+f),"YYYY-MM-D");m.value.push({prevMonth:!1,day:f,date:T,khDate:d.value(T),nextMonth:!0,attributes:K(T)})}$(),b.value=[...new Set(b.value.map(f=>f))]},$=()=>{let l;y.value.clone().month()+1<=4?l=y.value.clone().add(543,"years").locale("km").format("YYYY"):l=y.value.clone().add(544,"years").locale("km").format("YYYY"),S.value=(d.value(y.value.clone()).toKhDate("\u1786\u17D2\u1793\u17B6\u17C6a_e_\u1796.\u179F")+l).split("_")},K=l=>v.attributes.filter(h=>l.isSame(h.dates)),G=l=>{let h=Object.assign([],l);if(h.length){if(h.filter(r=>r.customData.description==="Holiday in Cambodia").length)return"text-red-600 bg-red-100";if(h.filter(r=>r.customData.description==="General Event").length)return"text-blue-600 bg-blue-100"}else return"bg-white"},B=(l,h)=>l==="\u17E8\u179A\u17C4\u1785"||l==="\u17E8\u1780\u17BE\u178F"||l==="\u17E1\u17E5\u1780\u17BE\u178F"||l==="\u17E1\u17E5\u179A\u17C4\u1785"?!0:l==="\u17E1\u17E4\u179A\u17C4\u1785"&&d.value(h.clone().add(1,"days")).toKhDate("dN")==="\u17E1\u1780\u17BE\u178F",u=k({month:n.value,year:o.value});return X(u.value,()=>{o.value=u.value.year,n.value=u.value.month}),X(y,me.exports.debounce(()=>{u.value.year=o.value,u.value.month=n.value,m.value.length=0,j()},300)),(l,h)=>(g(),p("div",ye,[t("div",_e,[t("div",xe,[Ye,t("button",{onClick:C(D,["prevent"]),class:"rounded-md hover:bg-gray-200 p-2",type:"button"},[O(M(V),{class:"w-5"})],8,we),Q(t("select",{"onUpdate:modelValue":h[0]||(h[0]=r=>u.value.month=r),class:"border rounded-md py-2 px-3"},[(g(),p(I,null,U(12,r=>t("option",{key:r,value:r},x(M(_)({M:r-1}).format("MMMM")),9,ke)),64))],512),[[Z,u.value.month]]),t("button",{onClick:C(N,["prevent"]),class:"rounded-md hover:bg-gray-200 p-2",type:"button"},[O(M(W),{class:"w-5"})],8,Me)]),t("div",De,[je,t("button",{onClick:C(s,["prevent"]),class:"rounded-md hover:bg-gray-200 p-2",type:"button"},[O(M(V),{class:"w-5"})],8,$e),Q(t("select",{"onUpdate:modelValue":h[1]||(h[1]=r=>u.value.year=r),class:"border rounded-md py-2 px-3"},[(g(),p(I,null,U(1e3,(r,L)=>t("option",{key:r,value:1900+L},x(1900+L),9,Te)),64))],512),[[Z,u.value.year]]),t("button",{onClick:C(Y,["prevent"]),class:"rounded-md hover:bg-gray-200 p-2",type:"button"},[O(M(W),{class:"w-5"})],8,Ce)])]),t("div",Se,[t("div",Oe,[t("div",Ne,[t("div",null,x(S.value[0]),1),t("div",null,x(S.value[1]),1),t("div",null,x(S.value[2]),1)]),t("div",Ie,[t("h2",Le,x(b.value.toString()),1),t("h2",Ee,x(M(y).format("MMMM, YYYY")),1)]),t("div",Pe,[t("button",{type:"button",class:"rounded-md hover:bg-gray-200 p-2",onClick:C(D,["prevent"])},[O(M(V),{class:"w-5 h-5"})],8,Ke),t("button",{type:"button",class:"rounded-full w-3 h-3 bg-gray-200 hover:bg-gray-300",onClick:C(c,["prevent"])},null,8,Be),t("button",{type:"button",class:"rounded-md hover:bg-gray-200 p-2",onClick:C(N,["prevent"])},[O(M(W),{class:"w-5 h-5"})],8,He)])]),t("div",Ue,[(g(!0),p(I,null,U(i.value,(r,L)=>(g(),p("div",{key:r,class:F([L===0?"text-red-600":"","w-full py-2 md:py-3"])},[t("div",null,x(r.km.format("dddd")),1)],2))),128))]),t("div",Fe,[(g(!0),p(I,null,U(m.value,r=>(g(),p("div",{key:r,onClick:C(L=>w(r.date),["prevent"]),class:F(["w-full aspect-[10/8] relative shadow rounded-md border md:p-2 whitespace-nowrap cursor-pointer transform duration-150 hover:scale-105 ease-in-out",[r.prevMonth||r.nextMonth?"opacity-20 bg-gray-100":"bg-white",G(r.attributes),r.date.weekday()===6?"text-red-600":"",M(_)().isSame(r.date,"day")?"bg-blue-600 text-white":""]])},[t("div",ze,[t("div",Ge,x(r.day),1),t("div",Ve,[t("div",null,x(r.khDate.toKhDate("dN")),1),B(r.khDate.toKhDate("dN"),r.date)?(g(),p("div",We,Xe)):z("",!0)])]),(r.khDate.khDay()===0||r.day===1)&&r.nextMonth===!1?(g(),p("div",qe,x(r.khDate.toKhDate("m")),1)):z("",!0)],10,Re))),128))])])]))}};function Qe(e){var a=typeof e;return e!=null&&(a=="object"||a=="function")}var J=Qe,Ze=typeof R=="object"&&R&&R.Object===Object&&R,et=Ze,tt=et,at=typeof self=="object"&&self&&self.Object===Object&&self,nt=tt||at||Function("return this")(),le=nt,rt=le,ot=function(){return rt.Date.now()},lt=ot,st=/\s/;function it(e){for(var a=e.length;a--&&st.test(e.charAt(a)););return a}var ut=it,dt=ut,ct=/^\s+/;function vt(e){return e&&e.slice(0,dt(e)+1).replace(ct,"")}var ht=vt,ft=le,mt=ft.Symbol,se=mt,ee=se,ie=Object.prototype,bt=ie.hasOwnProperty,gt=ie.toString,H=ee?ee.toStringTag:void 0;function pt(e){var a=bt.call(e,H),v=e[H];try{e[H]=void 0;var d=!0}catch{}var i=gt.call(e);return d&&(a?e[H]=v:delete e[H]),i}var yt=pt,_t=Object.prototype,xt=_t.toString;function Yt(e){return xt.call(e)}var wt=Yt,te=se,kt=yt,Mt=wt,Dt="[object Null]",jt="[object Undefined]",ae=te?te.toStringTag:void 0;function $t(e){return e==null?e===void 0?jt:Dt:ae&&ae in Object(e)?kt(e):Mt(e)}var Tt=$t;function Ct(e){return e!=null&&typeof e=="object"}var St=Ct,Ot=Tt,Nt=St,It="[object Symbol]";function Lt(e){return typeof e=="symbol"||Nt(e)&&Ot(e)==It}var Et=Lt,Pt=ht,ne=J,Kt=Et,re=0/0,Bt=/^[-+]0x[0-9a-f]+$/i,Ht=/^0b[01]+$/i,Ut=/^0o[0-7]+$/i,Ft=parseInt;function Rt(e){if(typeof e=="number")return e;if(Kt(e))return re;if(ne(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=ne(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=Pt(e);var v=Ht.test(e);return v||Ut.test(e)?Ft(e.slice(2),v?2:8):Bt.test(e)?re:+e}var zt=Rt,Gt=J,A=lt,oe=zt,Vt="Expected a function",Wt=Math.max,At=Math.min;function Xt(e,a,v){var d,i,m,n,o,b,y=0,S=!1,D=!1,N=!0;if(typeof e!="function")throw new TypeError(Vt);a=oe(a)||0,Gt(v)&&(S=!!v.leading,D="maxWait"in v,m=D?Wt(oe(v.maxWait)||0,a):m,N="trailing"in v?!!v.trailing:N);function s(u){var l=d,h=i;return d=i=void 0,y=u,n=e.apply(h,l),n}function Y(u){return y=u,o=setTimeout(j,a),S?s(u):n}function c(u){var l=u-b,h=u-y,r=a-l;return D?At(r,m-h):r}function w(u){var l=u-b,h=u-y;return b===void 0||l>=a||l<0||D&&h>=m}function j(){var u=A();if(w(u))return $(u);o=setTimeout(j,c(u))}function $(u){return o=void 0,N&&d?s(u):(d=i=void 0,n)}function K(){o!==void 0&&clearTimeout(o),y=0,d=b=i=o=void 0}function G(){return o===void 0?n:$(A())}function B(){var u=A(),l=w(u);if(d=arguments,i=this,b=u,l){if(o===void 0)return Y(b);if(D)return clearTimeout(o),o=setTimeout(j,a),s(b)}return o===void 0&&(o=setTimeout(j,a)),n}return B.cancel=K,B.flush=G,B}var qt=Xt,Jt=qt,Qt=J,Zt="Expected a function";function ea(e,a,v){var d=!0,i=!0;if(typeof e!="function")throw new TypeError(Zt);return Qt(v)&&(d="leading"in v?!!v.leading:d,i="trailing"in v?!!v.trailing:i),Jt(e,a,{leading:d,maxWait:a,trailing:i})}var ta=ea;const aa={class:"flex-col-reverse lg:flex flex-col lg:flex-row gap-4 mx-auto"},na={class:"w-full lg:w-2/3 shrink-0"},ra={class:"w-full"},oa={class:"relative max-w-4xl max-h-screen h-full md:h-auto pointer-events-auto w-full"},la={class:"border-2 border-white rounded-xl overflow-hidden relative p-4 bg-white w-full font-nokora md:text-lg lg:text-2xl"},sa={class:"text-lg md:text-xl lg:text-2xl font-bold"},ia={class:"mt-4"},ua={key:0,class:"list-outside list-disc pl-3 mt-3"},va={__name:"SPCalendar",setup(e){const{khmerDate:a}=q(),{events:v,traditional_events:d}=he(),i=k([{key:1,customData:{title:{kh:"\u1790\u17D2\u1784\u17C3",en:"today"},class:"bg-blue-600 text-white"},dates:P().format()}]),m=k({}),n=k({}),o=k(!1),b=k({month:null,year:null}),y=s=>{m.value={m:s.month,y:s.year},b.value=s,D(s)};X(b,ta(()=>{i.value.length=0,D(b.value)},0));const S=s=>{o.value=!0,n.value={date:s,attributes:i.value.filter(Y=>s.isSame(Y.dates,"day"))}},D=s=>{if(s.month===4){const{khmerNewYearAttrs:c}=be(s);i.value.push(...c.value)}v.value.filter(c=>c.start_date.month===s.month).forEach(c=>{i.value.push({key:"events"+P({y:s.year,M:s.month-1,D:c.start_date.day}).format("YYYY-MM-DD"),customData:{title:c.summary,description:c.description,class:"bg-red-600 text-white"},dates:P({y:s.year,M:s.month-1,D:c.start_date.day}).format("YYYY-MM-DD")})});let Y=P({y:s.year,M:s.month-1}).daysInMonth();for(let c=1;c<=Y;c++){let w=P({y:s.year,M:s.month-1,D:c}),j=[...a.value(w).toKhDate("dN_m").split("_")];d.value.filter($=>$.start_date.day===j[0]&&$.start_date.month===j[1]).forEach($=>{i.value.push({key:"traditional_events"+w,customData:{title:$.summary,description:$.description,class:"bg-red-600 text-white"},dates:w.format("YYYY-MM-DD")})}),N(j[0],w)&&i.value.push({key:"holy-day"+w,customData:{title:{kh:"\u1790\u17D2\u1784\u17C3\u200B\u179F\u17B8\u179B",en:"Holy Day"},description:"Buddhist Holy Day",class:"text-yellow-600"},dates:w.format("YYYY-MM-DD")})}i.value.sort(function(c,w){return new Date(c.dates)-new Date(w.dates)})},N=(s,Y)=>s==="\u17E8\u179A\u17C4\u1785"||s==="\u17E8\u1780\u17BE\u178F"||s==="\u17E1\u17E5\u1780\u17BE\u178F"||s==="\u17E1\u17E5\u179A\u17C4\u1785"?!0:s==="\u17E1\u17E4\u179A\u17C4\u1785"&&a.value(Y.clone().add(1,"days")).toKhDate("dN")!=="\u17E1\u17E5\u179A\u17C4\u1785";return(s,Y)=>(g(),p(I,null,[t("div",aa,[t("div",na,[O(Je,{attributes:i.value,onOnUpdatePage:y,onOnClick:S},null,8,["attributes"])]),t("div",ra,[O(fe,{title:"\u1796\u17D2\u179A\u17B9\u178F\u17D2\u178F\u17B7\u1780\u17B6\u179A\u178E\u17CD\u1794\u17D2\u179A\u1785\u17B6\u17C6 \u1781\u17C2"+M(P)({M:m.value.m-1,y:m.value.y}).locale("km").format("MMMM \u1786\u17D2\u1793\u17B6\u17C6YYYY"),events:i.value},null,8,["title","events"])])]),t("div",{class:F(o.value?"fixed bg-black/50  z-10 inset-0 ":"hidden"),onClick:Y[0]||(Y[0]=C(c=>o.value=!1,["prevent"]))},null,2),t("div",{tabindex:"-1","aria-hidden":"true",class:F([o.value?"fixed":"hidden"," inset-0 z-50 flex items-center justify-center pointer-events-none"])},[t("div",oa,[t("button",{type:"button",onClick:Y[1]||(Y[1]=C(c=>o.value=!1,["prevent"])),class:"absolute -top-2 -right-2 w-6 h-6 grid place-content-center rounded-full bg-white z-30 text-red-600"},[O(M(pe),{class:"h-5"})]),t("div",la,[n.value.date?(g(),p(I,{key:0},[t("h4",sa,x(n.value.date.clone().format("LL"))+", "+x(n.value.date.clone().locale("en").format("LL")),1),t("p",ia,x(M(a)(n.value.date).toLunarDate()),1),n.value.attributes?(g(),p("ul",ua,[(g(!0),p(I,null,U(n.value.attributes,c=>(g(),p("li",{key:c.key,class:F(c.customData.description==="Holiday in Cambodia"?"text-red-600":"")},x(c.customData.title.kh),3))),128))])):z("",!0)],64)):z("",!0)])])],2)],64))}};export{va as default};
