import{r as f,u as O,h as U,o as c,c as h,a as e,m as u,b as A,w as G,d as T,t as m,e as D,f as K,g as j,F as L,i as z,n as P,j as B,k as W,_ as X}from"./index.dc97188d.js";import{l as q}from"./lodash.e5c8ce12.js";function J(w){const i=f([]),{khmerNewYearDate:$}=O();let p=$.value(w.year).days;return p.forEach((d,g)=>{let a={};g===0?a={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u1798\u17A0\u17B6\u179F\u1784\u17D2\u179A\u17D2\u1780\u17B6\u1793\u17D2\u178F)",en:"Khmer New Year's Day (Moha Sangkranta)"}:d===p[p.length-1]?a={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u179C\u17B6\u179A\u17C8\u17A1\u17BE\u1784\u179F\u17D0\u1780)",en:"Khmer New Year's Day (Veareak Laeung Sak)"}:a={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u179C\u17B6\u179A\u17C8\u179C\u17D0\u1793\u1794\u178F)",en:"Khmer New Year's Day (Veareak Vanabat)"},i.value.push({key:"traditional_holidays"+U(d).format("YYYY-MM-DD"),customData:{title:a,description:"Holiday in Cambodia",class:"bg-red-600 text-white"},dates:U(d).format("YYYY-MM-DD")})}),{khmerNewYearAttrs:i}}const Q="/khmer-lunar/assets/buddhist-icon.d62fdc83.webp";function R(w,i){return c(),h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z","clip-rule":"evenodd"})])}function Z(w,i){return c(),h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function ee(w,i){return c(),h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}const te={class:"p-5"},ae={class:"font-nokora w-full bg-white border mx-auto p-2 rounded-xl"},le={class:"items-center justify-between flex mb-4"},se={class:"shrink-0 text-right text-lg font-bold"},oe={class:"text-center w-full"},ne={class:"text-lg md:text-xl lg:text-2xl font-bold"},re={class:"text-lg md:text-xl text-gray-600 font-bold"},ie={class:"flex gap-1 items-center justify-between shrink-0"},ue=["onClick"],de=["onClick"],ce=["onClick"],he={class:"flex gap-2 justify-between text-center items-center mb-2 bg-white rounded-md border overflow-hidden font-bold text-base md:text-lg whitespace-nowrap"},ve={class:"grid gap-2 grid-cols-7"},me=["onClick"],fe={class:"flex lg:gap-1 flex-col items-center md:flex-row md:items-start"},pe={class:"text-lg md:text-3xl font-bold shrink-0"},xe={class:"w-full flex justify-center flex-col md:justify-start items-center md:items-end font-nokora text-sm md:text-base text-center"},_e={key:0,class:"absolute inset-0 rounded-md overflow-hidden flex justify-center z-10 opacity-30 lg:static lg:opacity-100 p-1"},ge=e("img",{src:Q,alt:"Buddhist",class:"h-full object-cover object-top lg:w-6 lg:h-auto lg:object-contain"},null,-1),ye=[ge],be={key:0,class:"text-blue-600 font-bold hidden md:block"},Ye={__name:"TheCalendar",props:{attributes:Object},emits:["onPrev","onNext","onUpdatePage","onClick"],setup(w,{emit:i}){const $=w,{khmerDate:p}=O(),d=f([]),g=f([]),a=f(u().month()+1),r=f(u().year()),x=f([]),b=A(()=>u(r.value+"-"+a.value+"-1","YYYY-M-D")),C=f([]),H=()=>{a.value--,a.value===0&&(a.value=12,r.value--),i("onPrev",{month:a.value,year:r.value}),i("onUpdatePage",{month:a.value,year:r.value})},I=()=>{a.value++,a.value===13&&(a.value=1,r.value++),i("onNext",{month:a.value,year:r.value}),i("onUpdatePage",{month:a.value,year:r.value})},t=()=>{a.value=u().month()+1,r.value=u().year()},v=l=>{i("onClick",l)};G(b,q.exports.debounce(()=>{g.value.length=0,o()},100)),T(()=>{g.value.length=0,o()});const o=()=>{i("onPrev",{month:a.value,year:r.value}),i("onNext",{month:a.value,year:r.value}),i("onUpdatePage",{month:a.value,year:r.value}),d.value.length=0,x.value.length=0;for(let n=0;n<7;n++)d.value.push({en:u().day(n),km:u().clone().locale("km").day(n)});let l=b.value,_=l.clone().daysInMonth(),s=l.day(),E=7-u(l.format("YYYY-MM-"+_)).day()-1,F=l.clone().subtract(1,"months").daysInMonth();for(let n=s;n>0;n--){let y=F-n+1,N=u(l.clone().subtract(1,"months").format("YYYY-MM-"+y),"YYYY-MM-D");g.value.push({prevMonth:!0,day:y,date:N,khDate:p.value(N),nextMonth:!1,attributes:k(N)})}for(let n=1;n<=_;n++){let y=u(l.format("YYYY-MM-"+n),"YYYY-MM-D"),N=p.value(y);g.value.push({prevMonth:!1,day:n,date:y,khDate:N,nextMonth:!1,attributes:k(y)}),x.value.push(N.toKhDate("m"))}for(let n=1;n<=E;n++){let y=u(l.clone().add(1,"months").format("YYYY-MM-"+n),"YYYY-MM-D");g.value.push({prevMonth:!1,day:n,date:y,khDate:p.value(y),nextMonth:!0,attributes:k(y)})}Y(),x.value=[...new Set(x.value.map(n=>n))]},Y=()=>{let l;b.value.clone().month()+1<=4?l=b.value.clone().add(543,"years").locale("km").format("YYYY"):l=b.value.clone().add(544,"years").locale("km").format("YYYY"),C.value=(p.value(b.value.clone()).toKhDate("\u1786\u17D2\u1793\u17B6\u17C6a_e_\u1796.\u179F")+l).split("_")},k=l=>$.attributes.filter(_=>l.isSame(_.dates)),M=l=>{let _=Object.assign([],l);if(_.length){if(_.filter(s=>s.customData.description==="Holiday in Cambodia").length)return"text-red-600 bg-red-100";if(_.filter(s=>s.customData.description==="General Event").length)return"text-blue-600 bg-blue-100"}else return"bg-white"},V=(l,_)=>l==="\u17E8\u179A\u17C4\u1785"||l==="\u17E8\u1780\u17BE\u178F"||l==="\u17E1\u17E5\u1780\u17BE\u178F"||l==="\u17E1\u17E5\u179A\u17C4\u1785"?!0:l==="\u17E1\u17E4\u179A\u17C4\u1785"&&p.value(_.clone().add(1,"days")).toKhDate("dN")==="\u17E1\u1780\u17BE\u178F";return(l,_)=>(c(),h("div",te,[e("div",ae,[e("div",le,[e("div",se,[e("div",null,m(C.value[0]),1),e("div",null,m(C.value[1]),1),e("div",null,m(C.value[2]),1)]),e("div",oe,[e("h2",ne,m(x.value.toString()),1),e("h2",re,m(D(b).format("MMMM, YYYY")),1)]),e("div",ie,[e("button",{type:"button",class:"rounded-md hover:bg-gray-200 p-2",onClick:K(H,["prevent"])},[j(D(R),{class:"w-5 h-5"})],8,ue),e("button",{type:"button",class:"rounded-full w-3 h-3 bg-gray-200 hover:bg-gray-300",onClick:K(t,["prevent"])},null,8,de),e("button",{type:"button",class:"rounded-md hover:bg-gray-200 p-2",onClick:K(I,["prevent"])},[j(D(Z),{class:"w-5 h-5"})],8,ce)])]),e("div",he,[(c(!0),h(L,null,z(d.value,(s,S)=>(c(),h("div",{key:s,class:P([S===0?"text-red-600":"","w-full py-2 md:py-3"])},[e("div",null,m(s.km.format("dddd")),1)],2))),128))]),e("div",ve,[(c(!0),h(L,null,z(g.value,s=>(c(),h("div",{key:s,onClick:K(S=>v(s.date),["prevent"]),class:P(["w-full aspect-[10/8] relative shadow rounded-md border md:p-2 whitespace-nowrap cursor-pointer transform duration-150 hover:scale-105 ease-in-out",[s.prevMonth||s.nextMonth?"opacity-20 bg-gray-100":"bg-white",M(s.attributes),s.date.weekday()===0?"text-red-600":"",D(u)().isSame(s.date,"day")?"bg-blue-600 text-white":""]])},[e("div",fe,[e("div",pe,m(s.day),1),e("div",xe,[e("div",null,m(s.khDate.toKhDate("dN")),1),V(s.khDate.toKhDate("dN"),s.date)?(c(),h("div",_e,ye)):B("",!0)])]),(s.khDate.khDay()===0||s.day===1)&&s.nextMonth===!1?(c(),h("div",be,m(s.khDate.toKhDate("m")),1)):B("",!0)],10,me))),128))])])]))}},we={class:"flex-col-reverse lg:flex flex-col lg:flex-row gap-4 mx-auto"},ke={class:"w-full lg:w-2/3 shrink-0"},Me={class:"w-full"},De={class:"relative max-w-4xl max-h-screen h-full md:h-auto pointer-events-auto w-full"},Ce={class:"border-2 border-white rounded-xl overflow-hidden relative p-4 bg-white w-full font-nokora md:text-lg lg:text-2xl"},Ne={class:"text-lg md:text-xl lg:text-2xl font-bold"},Ke={class:"mt-4"},$e={key:0,class:"list-outside list-disc pl-3 mt-3"},Pe={__name:"SPCalendar",setup(w){const{khmerDate:i}=O(),{events:$,traditional_events:p}=W(),d=f([{key:1,customData:{title:{kh:"\u1790\u17D2\u1784\u17C3",en:"today"},class:"bg-blue-600 text-white"},dates:u().format()}]),g=f([]),a=f({}),r=f({}),x=f(!1),b=t=>{a.value={m:t.month,y:t.year},g.value.length=0,d.value.length=0,H(t),d.value.sort(function(v,o){return new Date(v.dates)-new Date(o.dates)})},C=t=>{x.value=!0,r.value={date:t,attributes:d.value.filter(v=>t.isSame(v.dates,"day"))}},H=t=>{if(t.month===4){const{khmerNewYearAttrs:o}=J(t);d.value.push(...o.value)}$.value.filter(o=>o.start_date.month===t.month).forEach(o=>{d.value.push({key:"events"+u({y:t.year,M:t.month-1,D:o.start_date.day}).format("YYYY-MM-DD"),customData:{title:o.summary,description:o.description,class:"bg-red-600 text-white"},dates:u({y:t.year,M:t.month-1,D:o.start_date.day}).format("YYYY-MM-DD")})});let v=u({y:t.year,M:t.month-1}).daysInMonth();for(let o=1;o<=v;o++){let Y=u({y:t.year,M:t.month-1,D:o}),k=[...i.value(Y).toKhDate("dN_m").split("_")];p.value.filter(M=>M.start_date.day===k[0]&&M.start_date.month===k[1]).forEach(M=>{d.value.push({key:"traditional_events"+Y,customData:{title:M.summary,description:M.description,class:"bg-red-600 text-white"},dates:Y})}),I(k[0],Y)&&d.value.push({key:"holy-day"+Y,customData:{title:{kh:"\u1790\u17D2\u1784\u17C3\u200B\u179F\u17B8\u179B",en:"Holy Day"},description:"Buddhist Holy Day",class:"text-yellow-600"},dates:Y})}},I=(t,v)=>t==="\u17E8\u179A\u17C4\u1785"||t==="\u17E8\u1780\u17BE\u178F"||t==="\u17E1\u17E5\u1780\u17BE\u178F"||t==="\u17E1\u17E5\u179A\u17C4\u1785"?!0:t==="\u17E1\u17E4\u179A\u17C4\u1785"&&i.value(v.clone().add(1,"days")).toKhDate("dN")==="\u17E1\u1780\u17BE\u178F";return(t,v)=>(c(),h(L,null,[e("div",we,[e("div",ke,[j(Ye,{attributes:d.value,onOnUpdatePage:b,onOnClick:C},null,8,["attributes"])]),e("div",Me,[j(X,{title:"\u1796\u17D2\u179A\u17B9\u178F\u17D2\u178F\u17B7\u1780\u17B6\u179A\u178E\u17CD\u1794\u17D2\u179A\u1785\u17B6\u17C6 \u1781\u17C2"+D(u)({M:a.value.m-1,y:a.value.y}).locale("km").format("MMMM \u1786\u17D2\u1793\u17B6\u17C6YYYY"),events:d.value},null,8,["title","events"])])]),e("div",{class:P(x.value?"fixed bg-black/50  z-10 inset-0 ":"hidden"),onClick:v[0]||(v[0]=K(o=>x.value=!1,["prevent"]))},null,2),e("div",{tabindex:"-1","aria-hidden":"true",class:P([x.value?"fixed":"hidden"," inset-0 z-50 flex items-center justify-center pointer-events-none"])},[e("div",De,[e("button",{type:"button",onClick:v[1]||(v[1]=K(o=>x.value=!1,["prevent"])),class:"absolute -top-2 -right-2 w-6 h-6 grid place-content-center rounded-full bg-white z-30 text-red-600"},[j(D(ee),{class:"h-5"})]),e("div",Ce,[r.value.date?(c(),h(L,{key:0},[e("h4",Ne,m(r.value.date.clone().locale("km").format("LL"))+", "+m(r.value.date.clone().format("LL")),1),e("p",Ke,m(D(i)(r.value.date).toLunarDate()),1),r.value.attributes?(c(),h("ul",$e,[(c(!0),h(L,null,z(r.value.attributes,o=>(c(),h("li",{key:o.key,class:P(o.customData.description==="Holiday in Cambodia"?"text-red-600":"")},m(o.customData.title.kh),3))),128))])):B("",!0)],64)):B("",!0)])])],2)],64))}};export{Pe as default};
