import{r as Y,u as N,h as M,m as f,c as U,w as V,o as $,a as y,b as x,d as r,e as C,t as k,f as E,F as K,g as I,n as j,i as F,j as B,k as S,_ as A}from"./index.c445edac.js";function L(g){const d=Y([]),{khmerNewYearDate:b}=N();let m=b.value(g.year).days;return m.forEach((l,u)=>{let e={};u===0?e={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u1798\u17A0\u17B6\u179F\u1784\u17D2\u179A\u17D2\u1780\u17B6\u1793\u17D2\u178F)",en:"Khmer New Year's Day (Moha Sangkranta)"}:l===m[m.length-1]?e={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u179C\u17B6\u179A\u17C8\u17A1\u17BE\u1784\u179F\u17D0\u1780)",en:"Khmer New Year's Day (Veareak Laeung Sak)"}:e={kh:"\u1796\u17B7\u1792\u17B8\u1794\u17BB\u178E\u17D2\u1799\u1785\u17BC\u179B\u1786\u17D2\u1793\u17B6\u17C6\u1790\u17D2\u1798\u17B8 \u1794\u17D2\u179A\u1796\u17C3\u178E\u17B8\u1787\u17B6\u178F\u17B7 (\u179C\u17B6\u179A\u17C8\u179C\u17D0\u1793\u1794\u178F)",en:"Khmer New Year's Day (Veareak Vanabat)"},d.value.push({key:"traditional_holidays"+M(l).format("YYYY-MM-DD"),customData:{title:e,description:"Holiday in Cambodia",class:"bg-red-600 text-white"},dates:M(l).format("YYYY-MM-DD")})}),{khmerNewYearAttrs:d}}const z={class:"p-5"},T={class:"font-nokora w-full bg-white border mx-auto p-2 rounded-xl"},W={class:"items-center justify-between flex mb-4"},X=["onClick"],q={class:"text-center"},G={class:"text-lg md:text-xl lg:text-2xl font-bold"},J={class:"text-lg md:text-xl text-gray-600 font-bold"},Q=["onClick"],R={class:"flex gap-2 justify-between text-center items-center mb-2 bg-white rounded-md border overflow-hidden font-bold text-lg"},Z={class:"grid gap-2 grid-cols-7"},ee={class:"flex lg:gap-1 flex-col items-center md:flex-row md:items-start"},te={class:"text-lg md:text-3xl font-bold shrink-0"},ae={class:"w-full flex justify-center flex-col md:justify-start items-center md:items-end font-nokora text-sm md:text-base text-center"},se={key:0,class:"text-blue-600 hidden md:block"},ne={__name:"TheCalendar",props:{attributes:Object,currentKhmerMonths:String},emits:["onPrev","onNext","onUpdatePage"],setup(g,{emit:d}){const b=g,{khmerDate:m}=N(),l=Y([]),u=Y([]),e=Y(f().month()+1),h=Y(f().year()),p=U(()=>f(h.value+"-"+e.value+"-1","YYYY-M-D")),o=()=>{e.value--,e.value===0&&(e.value=12,h.value--),d("onPrev",{month:e.value,year:h.value}),d("onUpdatePage",{month:e.value,year:h.value})},D=()=>{e.value++,e.value===13&&(e.value=1,h.value++),d("onNext",{month:e.value,year:h.value}),d("onUpdatePage",{month:e.value,year:h.value})};V(p,()=>{u.value.length=0,a()}),$(()=>{d("onPrev",{month:e.value,year:h.value}),d("onNext",{month:e.value,year:h.value}),d("onUpdatePage",{month:e.value,year:h.value}),u.value.length=0,a()});const a=()=>{l.value.length=0;for(let n=0;n<7;n++)l.value.push(f().locale("km").day(n).format("dddd"));let t=p.value,c=t.clone().daysInMonth(),s=t.day(),H=7-f(t.format("YYYY-MM-"+c)).day()-1,O=t.clone().subtract(1,"months").daysInMonth();for(let n=s;n>0;n--){let v=O-n+1,w=f(t.clone().subtract(1,"months").format("YYYY-MM-"+v),"YYYY-MM-D");u.value.push({prevMonth:!0,day:v,date:w,khDate:m.value(w),nextMonth:!1,attributes:i(w)})}for(let n=1;n<=c;n++){let v=f(t.format("YYYY-MM-"+n),"YYYY-MM-D");u.value.push({prevMonth:!1,day:n,date:v,khDate:m.value(v),nextMonth:!1,attributes:i(v)})}for(let n=1;n<=H;n++){let v=f(t.clone().add(1,"months").format("YYYY-MM-"+n),"YYYY-MM-D");u.value.push({prevMonth:!1,day:n,date:v,khDate:m.value(v),nextMonth:!0,attributes:i(v)})}},i=t=>b.attributes.filter(c=>t.isSame(c.dates)),_=t=>{let c=Object.assign([],t);return c.length?c.filter(s=>s.customData.description==="Holiday in Cambodia").length?"text-red-600 bg-red-100":"text-blue-600 bg-blue-100":"bg-white"};return(t,c)=>(y(),x("div",z,[r("div",T,[r("div",W,[r("div",null,[r("button",{type:"button",onClick:C(o,["prevent"])},"Prev.",8,X)]),r("div",q,[r("h2",G,k(g.currentKhmerMonths),1),r("h2",J,k(E(p).format("MMMM, YYYY")),1)]),r("div",null,[r("button",{type:"button",onClick:C(D,["prevent"])},"Next",8,Q)])]),r("div",R,[(y(!0),x(K,null,I(l.value,(s,P)=>(y(),x("div",{key:s,class:j([P===0?"bg-red-600 text-white":"","w-full py-3"])},k(s),3))),128))]),r("div",Z,[(y(!0),x(K,null,I(u.value,s=>(y(),x("div",{key:s,class:j(["w-full aspect-[10/8] shadow rounded-md border md:p-2",[s.prevMonth||s.nextMonth?"opacity-20 bg-gray-100":"bg-white",_(s.attributes),s.date.weekday()===0?"text-red-600":""]])},[r("div",ee,[r("div",te,k(s.day),1),r("div",ae,[r("div",null,k(s.khDate.toKhDate("d N")),1)])]),(s.khDate.khDay()===0||s.day===1)&&s.nextMonth===!1?(y(),x("div",se,k(s.khDate.toKhDate("m")),1)):F("",!0)],2))),128))])])]))}},re={class:"flex-col-reverse lg:flex flex-col lg:flex-row gap-4 mx-auto"},oe={class:"w-full lg:w-2/3 shrink-0"},le={class:"w-full"},de={__name:"SPCalendar",setup(g){const{khmerDate:d}=N(),{events:b,traditional_events:m}=B(),l=Y([{key:1,customData:{title:{kh:"\u1790\u17D2\u1784\u17C3",en:"today"},class:"bg-blue-600 text-white"},dates:M().format()}]),u=Y([]),e=Y([1,2]),h=o=>{u.value.length=0,l.value.length=0,p(o),l.value.sort(function(D,a){return new Date(D.dates)-new Date(a.dates)})},p=o=>{if(o.month===4){const{khmerNewYearAttrs:a}=L(o);l.value.push(...a.value)}b.value.filter(a=>a.start_date.month===o.month).forEach(a=>{l.value.push({key:"events"+M({y:o.year,M:o.month-1,D:a.start_date.day}).format("YYYY-MM-DD"),customData:{title:a.summary,description:a.description,class:"bg-red-600 text-white"},dates:M({y:o.year,M:o.month-1,D:a.start_date.day}).format("YYYY-MM-DD")})});let D=M({y:o.year,M:o.month-1}).daysInMonth();for(let a=1;a<=D;a++){let i=M({y:o.year,M:o.month-1,D:a}).format("YYYY-MM-DD"),_=d.value(i);u.value.push({khmer_month:_.toKhDate("m"),khmer_day:_.toKhDate("dN"),date:i}),m.value.filter(t=>u.value.filter(c=>c.khmer_month===t.start_date.month&&c.khmer_day===t.start_date.day).includes(t))}u.value.reduce(function(a,i){let _=m.value.filter(t=>t.start_date.month===i.khmer_month&&t.start_date.day===i.khmer_day);_.length&&_.forEach(t=>{l.value.push({key:"traditional_events"+i.date,customData:{title:t.summary,description:t.description,class:"bg-red-600 text-white"},dates:i.date})})}),e.value=[...new Set(u.value.map(a=>a.khmer_month))]};return(o,D)=>(y(),x("div",re,[r("div",oe,[S(ne,{attributes:l.value,onOnUpdatePage:h,"current-khmer-months":e.value[0]+" ~ "+e.value[1]},null,8,["attributes","current-khmer-months"])]),r("div",le,[S(A,{events:l.value},null,8,["events"])])]))}};export{de as default};
